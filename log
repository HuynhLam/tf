[ 0.91767538  0.00014502  0.03067821  0.01461464  0.00000031  0.02619745
  0.00006112  0.00001632  0.00128285  0.00932877]] (8.534 sec)
INFO:tensorflow:probabilities = [[ 0.00000007  0.00000013  0.00000003  0.00002956  0.00030793  0.00000936
  0.          0.00073733  0.0000014   0.99891412]
[ 0.00002419  0.93786681  0.0050379   0.01253423  0.01424031  0.00820767
  0.00368761  0.00034617  0.0175169   0.00053819]
[ 0.00003744  0.00000149  0.00010477  0.00000253  0.00032214  0.00003565
  0.99947244  0.00000004  0.00002084  0.00000269]
[ 0.99996471  0.00000001  0.00000139  0.00000003  0.00000008  0.0000146
  0.0000171   0.00000001  0.00000014  0.00000187]
[ 0.00003614  0.00000033  0.0003592   0.00326812  0.00000909  0.00499567
  0.00041941  0.00000202  0.98887831  0.00203167]
[ 0.00001928  0.00000013  0.0000233   0.000101    0.0000123   0.00063584
  0.0009834   0.00000002  0.9981792   0.00004555]
[ 0.00000151  0.00000065  0.00009263  0.00311383  0.00000257  0.00009415
  0.00001718  0.00000061  0.99639374  0.00028315]
[ 0.00000412  0.00000085  0.00000054  0.00053002  0.00000006  0.99940777
  0.00000008  0.00001607  0.00003192  0.00000856]
[ 0.00000233  0.0000007   0.00006353  0.0000002   0.00112662  0.00010591
  0.99866343  0.00000001  0.00003719  0.00000006]
[ 0.00003488  0.00073467  0.00032552  0.00174627  0.00227127  0.00283485
  0.00000214  0.96396303  0.00086943  0.02721796]
[ 0.01586818  0.00000014  0.93760663  0.00104425  0.00007031  0.00019788
  0.00028934  0.00002199  0.0446903   0.00021096]
[ 0.00008062  0.00087545  0.00037286  0.03471428  0.00247516  0.01656492
  0.08863231  0.00000973  0.85521168  0.00106307]
[ 0.00000906  0.00010754  0.00001871  0.00000084  0.00000446  0.00280422
  0.99703938  0.00000002  0.00001582  0.00000001]
[ 0.00014248  0.00000306  0.00037607  0.00000207  0.00008307  0.00264031
  0.99627566  0.00000007  0.00046956  0.00000775]
[ 0.          0.00000008  0.00071493  0.99888378  0.00000001  0.00000009
  0.          0.00024548  0.00012361  0.00003197]
[ 0.00029632  0.00000925  0.00250142  0.00520422  0.0000851   0.00424362
  0.04564598  0.00000002  0.94172633  0.00028778]
[ 0.00000375  0.0009932   0.9923774   0.00626282  0.0000001   0.0000017
  0.00002262  0.          0.00033823  0.00000005]
[ 0.0079554   0.00004059  0.0011457   0.03098317  0.00017292  0.0351459
  0.00250021  0.0000044   0.92105329  0.00099835]
[ 0.00001464  0.00000035  0.00006612  0.97253686  0.00000051  0.02159619
  0.00000035  0.0000004   0.00537442  0.00041016]
[ 0.99999917  0.          0.0000004   0.00000001  0.          0.
  0.00000045  0.          0.          0.00000004]
[ 0.0000084   0.00000115  0.00034082  0.00121685  0.00009208  0.95088255
  0.02500636  0.00000085  0.02239165  0.00005931]
[ 0.00030522  0.00000008  0.00000813  0.00000181  0.00009506  0.00007783
  0.99951136  0.          0.00000049  0.00000012]
[ 0.00018342  0.99576074  0.00028854  0.00030163  0.00080966  0.00002788
  0.00054935  0.00141424  0.00052216  0.00014235]
[ 0.00001302  0.00136472  0.00057576  0.0005582   0.99406201  0.00055429
  0.0006685   0.00046123  0.00004439  0.00169782]
[ 0.00000128  0.00000874  0.99832243  0.00163333  0.          0.00000167
  0.00000003  0.00000005  0.00003239  0.00000011]
[ 0.0224091   0.000175    0.00011806  0.04336779  0.00109713  0.91156453
  0.00002111  0.00045497  0.00015696  0.02063536]
[ 0.00001561  0.00000002  0.00000634  0.00086143  0.00000013  0.85111064
  0.00000102  0.0000021   0.14798833  0.00001428]
[ 0.99311274  0.00000132  0.00035193  0.00383763  0.00001065  0.00189107
  0.00016538  0.00026318  0.00002345  0.00034255]
[ 0.00000021  0.00000047  0.00000127  0.0000263   0.03423885  0.00012764
  0.00000032  0.0002723   0.00022472  0.96510792]
[ 0.00009283  0.25906095  0.0007316   0.01439724  0.04401957  0.00865498
  0.00087582  0.0008795   0.65826595  0.01302156]
[ 0.00028358  0.98437411  0.00050586  0.00310277  0.00093239  0.00029856
  0.00034253  0.00247505  0.00398931  0.00369578]
[ 0.00023011  0.00046547  0.00047066  0.00111463  0.00136265  0.00055435
  0.99355197  0.00000211  0.00219661  0.00005141]
[ 0.00000002  0.00000014  0.00000056  0.00000107  0.99978358  0.00000279
  0.00000094  0.00000096  0.00002245  0.0001874 ]
[ 0.00282986  0.00387617  0.00319393  0.00496379  0.00041843  0.01266619
  0.00065853  0.00510808  0.95577449  0.01051051]
[ 0.00018822  0.94802469  0.0067647   0.00659298  0.00590015  0.00603244
  0.01072102  0.0001237   0.01525148  0.00040048]
[ 0.00000353  0.00000111  0.00109931  0.99796909  0.00000003  0.00005908
  0.00000003  0.00000032  0.0008341   0.00003334]
[ 0.99863881  0.00000039  0.00086658  0.00000892  0.00001018  0.00004854
  0.00035574  0.00000699  0.00002801  0.0000357 ]
[ 0.00000143  0.0000001   0.00000181  0.00001022  0.00019999  0.00007877
  0.00000005  0.00985195  0.00008129  0.98977435]
[ 0.00002688  0.00000103  0.00004441  0.00047527  0.00223277  0.00003675
  0.00000973  0.00031855  0.00035807  0.99649662]
[ 0.00003022  0.9945305   0.00004747  0.00134295  0.00011563  0.00002602
  0.00035266  0.00000597  0.00343258  0.00011612]
[ 0.00102955  0.61904716  0.01098595  0.00155586  0.0191209   0.00228103
  0.00032092  0.00403464  0.3415373   0.00008664]
[ 0.00095139  0.00000009  0.00000062  0.000009    0.00003902  0.00046384
  0.00000011  0.99319494  0.00001643  0.00532466]
[ 0.00043127  0.0003664   0.88629401  0.08643648  0.00333371  0.00048353
  0.00001567  0.01122184  0.00065123  0.01076594]
[ 0.99764878  0.00000146  0.00022786  0.00009175  0.00000003  0.00187945
  0.00001117  0.00001962  0.00000521  0.00011465]
[ 0.00002769  0.00009081  0.00032178  0.00055115  0.00312657  0.00018373
  0.00000545  0.00679546  0.00015854  0.98873889]
[ 0.00031004  0.99317133  0.00227989  0.0004827   0.00021596  0.00000815
  0.00028931  0.00105059  0.0018718   0.00032022]
[ 0.00010321  0.05056946  0.002613    0.00045001  0.90752208  0.00202494
  0.00220216  0.00114493  0.0306369   0.00273329]
[ 0.00130814  0.00001066  0.00090836  0.00000604  0.00103094  0.00071903
  0.99587655  0.00000032  0.00013742  0.0000025 ]
[ 0.          0.00000035  0.9999938   0.0000045   0.00000096  0.00000001
  0.00000033  0.          0.00000001  0.        ]
[ 0.00018474  0.00002109  0.00079475  0.00075616  0.00001586  0.00009854
  0.00003414  0.00000396  0.9972887   0.00080198]
[ 0.00004055  0.00000022  0.99947172  0.00026533  0.00000056  0.00000387
  0.00000206  0.00016728  0.00004704  0.00000141]
[ 0.00001429  0.99816728  0.00009083  0.00024413  0.00025085  0.00004175
  0.00039794  0.00020533  0.00053913  0.00004839]
[ 0.00022606  0.00118327  0.01129531  0.00081513  0.335177    0.00162342
  0.64870381  0.000054    0.00059689  0.0003251 ]
[ 0.00000487  0.00000124  0.00002945  0.99967897  0.00000009  0.00022989
  0.00000339  0.00000001  0.00005014  0.00000189]
[ 0.00000043  0.00000001  0.00000088  0.00004792  0.000129    0.00002115
  0.00000001  0.00041675  0.00010062  0.99928325]
[ 0.00000061  0.00001383  0.00000124  0.00011301  0.00707033  0.00006784
  0.00000006  0.00286962  0.00040007  0.98946333]
[ 0.99995697  0.00000001  0.00000474  0.0000012   0.00000001  0.00001058
  0.00002532  0.00000049  0.00000012  0.00000059]
[ 0.00012103  0.00002049  0.00029867  0.00022115  0.00001107  0.00010081
  0.00000003  0.90161479  0.00007173  0.09754016]
[ 0.00002816  0.0002114   0.00035066  0.97844386  0.00000631  0.0069236
  0.00000157  0.00002524  0.01239796  0.00161142]
[ 0.03453721  0.00442368  0.0089411   0.07714608  0.00045304  0.82762349
  0.03496815  0.00020131  0.00209767  0.00960827]
[ 0.00000003  0.00000003  0.00006465  0.00000002  0.9998821   0.00000051
  0.00004538  0.0000056   0.0000002   0.00000148]
[ 0.0000107   0.00000203  0.000021    0.00009182  0.00569206  0.00000125
  0.00000135  0.01185693  0.0003187   0.98200423]
[ 0.00001532  0.00000113  0.00018749  0.00000063  0.00092225  0.00152273
  0.997334    0.          0.00001375  0.00000265]
[ 0.00115562  0.0342009   0.8512556   0.0358938   0.00009714  0.0014413
  0.00021986  0.07049841  0.00475464  0.00048273]
[ 0.00074764  0.00003322  0.00001448  0.02933796  0.00002918  0.95786226
  0.00009254  0.00000146  0.00697263  0.00490864]
[ 0.00001076  0.00028603  0.99791998  0.00007637  0.00000523  0.00000428
  0.00000445  0.00000147  0.00169093  0.00000053]
[ 0.00007828  0.00921476  0.00933854  0.00676611  0.00810833  0.00136993
  0.00007155  0.95756859  0.00132345  0.00616051]
[ 0.00003248  0.00016189  0.00041435  0.00033419  0.93699574  0.00030041
  0.00009252  0.00882235  0.00120711  0.05163898]
[ 0.00002045  0.00000001  0.00001147  0.00001721  0.00013407  0.00001616
  0.00000004  0.00473404  0.00002038  0.99504614]
[ 0.00067387  0.99068987  0.00028763  0.00024596  0.00042397  0.0000439
  0.00103027  0.00200775  0.00437646  0.00022034]
[ 0.00034476  0.00282592  0.91571254  0.04439736  0.00232104  0.001059
  0.0055635   0.00021236  0.02547367  0.00208977]
[ 0.00016718  0.00000012  0.00017881  0.0001719   0.00000005  0.00009768
  0.          0.99915731  0.00000365  0.00022336]
[ 0.0011881   0.00048812  0.39959317  0.59359545  0.00004905  0.00008401
  0.00006047  0.0010725   0.00370462  0.00016453]
[ 0.00441183  0.02514797  0.87936246  0.05588644  0.00003189  0.00030048
  0.03444166  0.00005561  0.00036056  0.00000113]
[ 0.00003378  0.99820733  0.00008874  0.00001036  0.00031204  0.00000379
  0.00012221  0.00005101  0.00116778  0.00000284]
[ 0.00001155  0.00000114  0.00003661  0.00248637  0.0000245   0.00177867
  0.00000026  0.99526274  0.0001324   0.00026573]
[ 0.00000011  0.          0.00000208  0.9990682   0.00000004  0.00079699
  0.          0.00000002  0.0000846   0.00004798]
[ 0.00000358  0.9995845   0.00003554  0.00000653  0.00006254  0.00000059
  0.00001022  0.00003181  0.00026344  0.0000012 ]
[ 0.00005899  0.99924302  0.00008676  0.00002398  0.00006426  0.00000309
  0.00016279  0.00012171  0.00023168  0.00000374]
[ 0.00001502  0.00000012  0.99983048  0.00006318  0.          0.00000028
  0.00000004  0.00001305  0.0000741   0.00000368]
[ 0.25627074  0.00040012  0.01504939  0.00003521  0.00655035  0.04403748
  0.67726779  0.00000428  0.00028696  0.00009778]
[ 0.00008238  0.01247946  0.03489502  0.95154119  0.00000233  0.00011022
  0.00000019  0.00015225  0.00064542  0.00009167]
[ 0.00092759  0.00365712  0.00141787  0.02736984  0.1204536   0.01073103
  0.00052461  0.07054111  0.00248543  0.7618919 ]
[ 0.00000593  0.0002406   0.99903405  0.00068855  0.00000009  0.00000015
  0.00000004  0.00002708  0.00000318  0.00000041]
[ 0.00000003  0.00000018  0.00000111  0.00010803  0.00797493  0.00005717
  0.00000064  0.00009311  0.00006675  0.99169803]
[ 0.00000115  0.00000251  0.00026733  0.01593546  0.00000064  0.00133984
  0.00000107  0.00000042  0.98243988  0.00001166]
[ 0.00024242  0.00090856  0.00018328  0.00019751  0.00068931  0.00680069
  0.98957598  0.00000146  0.0013386   0.0000621 ]
[ 0.00087774  0.93421644  0.00257249  0.01971595  0.00070648  0.00411114
  0.00084265  0.00962184  0.01498862  0.01234663]
[ 0.00000002  0.00000367  0.00016446  0.99884701  0.00000111  0.00091375
  0.00000011  0.00000002  0.00006645  0.00000338]
[ 0.00000802  0.00000082  0.0000089   0.00000669  0.99802893  0.00003081
  0.00000952  0.00003811  0.00001946  0.00184879]
[ 0.00111189  0.07563533  0.68913412  0.16918445  0.00015002  0.0023707
  0.01194248  0.0000375   0.05032101  0.00011244]
[ 0.99783653  0.00000003  0.00004244  0.0000393   0.00000034  0.0016262
  0.00000462  0.00008212  0.00014045  0.000228  ]
[ 0.97452182  0.00000598  0.00103898  0.0005063   0.00002142  0.00666817
  0.00010808  0.0022972   0.00003175  0.01480024]
[ 0.00002939  0.00000046  0.00000862  0.00001548  0.00073225  0.00023267
  0.00000188  0.00260996  0.00274922  0.9936201 ]
[ 0.0004371   0.00000012  0.02095018  0.0026192   0.00055937  0.00016432
  0.00000374  0.07713746  0.02189708  0.87623143]
[ 0.02071276  0.00296077  0.94993049  0.01298381  0.0000858   0.00688729
  0.00003657  0.0012714   0.0038737   0.00125742]
[ 0.0000011   0.00000056  0.0003329   0.00013331  0.00000003  0.0000001
  0.          0.99946636  0.00000013  0.00006542]
[ 0.00017714  0.00000181  0.00043429  0.01944529  0.0000053   0.00349416
  0.0008154   0.00000111  0.974549    0.00107647]
[ 0.00000112  0.00000003  0.00004759  0.00025943  0.0000001   0.0000275
  0.          0.99949586  0.00002645  0.00014187]
[ 0.00000007  0.00000016  0.00000023  0.00099013  0.00000027  0.99886864
  0.00005355  0.          0.00007781  0.00000915]] (8.599 sec)
INFO:tensorflow:Saving checkpoints for 20000 into /tmp/mnist_convnet_model/model.ckpt.
INFO:tensorflow:Loss for final step: 0.0887396.
WARNING:tensorflow:From mnist_cnn_layer.py:147: calling BaseEstimator.evaluate (from tensorflow.contrib.learn.python.learn.estimators.estimator) with x is deprecated and will be removed after 2016-12-01.
Instructions for updating:
Estimator is decoupled from Scikit Learn interface by moving into
separate class SKCompat. Arguments x, y and batch_size are only
available in the SKCompat class, Estimator will only accept input_fn.
Example conversion:
 est = Estimator(...) -> est = SKCompat(Estimator(...))
WARNING:tensorflow:From mnist_cnn_layer.py:147: calling BaseEstimator.evaluate (from tensorflow.contrib.learn.python.learn.estimators.estimator) with y is deprecated and will be removed after 2016-12-01.
Instructions for updating:
Estimator is decoupled from Scikit Learn interface by moving into
separate class SKCompat. Arguments x, y and batch_size are only
available in the SKCompat class, Estimator will only accept input_fn.
Example conversion:
 est = Estimator(...) -> est = SKCompat(Estimator(...))
INFO:tensorflow:Starting evaluation at 2017-06-14-09:40:53
INFO:tensorflow:Restoring parameters from /tmp/mnist_convnet_model/model.ckpt-20000
INFO:tensorflow:Finished evaluation at 2017-06-14-09:41:46
INFO:tensorflow:Saving dict for global step 20000: accuracy = 0.972, global_step = 20000, loss = 0.0957721
WARNING:tensorflow:Skipping summary for global_step, must be a float or np.float32.
{'loss': 0.095772132, 'accuracy': 0.972, 'global_step': 20000}


*********************************************************************************************************
3 conv + 3 pool + 3 FC, same batch size -> ran out of memory
[ 0.00025448  0.00002089  0.00007397  0.01755062  0.00019522  0.97058421
  0.00290558  0.0000006   0.00815061  0.00026372]] (3.087 sec)
INFO:tensorflow:Saving checkpoints for 20001 into /tmp/mnist_convnet_model/model.ckpt.
INFO:tensorflow:Loss for final step: 0.105971.
WARNING:tensorflow:From mnist_cnn_layer.py:147: calling evaluate (from tensorflow.contrib.learn.python.learn.estimators.estimator) with y is deprecated and will be removed after 2016-12-01.
Instructions for updating:
Estimator is decoupled from Scikit Learn interface by moving into
separate class SKCompat. Arguments x, y and batch_size are only
available in the SKCompat class, Estimator will only accept input_fn.
Example conversion:
 est = Estimator(...) -> est = SKCompat(Estimator(...))
WARNING:tensorflow:From mnist_cnn_layer.py:147: calling evaluate (from tensorflow.contrib.learn.python.learn.estimators.estimator) with x is deprecated and will be removed after 2016-12-01.
Instructions for updating:
Estimator is decoupled from Scikit Learn interface by moving into
separate class SKCompat. Arguments x, y and batch_size are only
available in the SKCompat class, Estimator will only accept input_fn.
Example conversion:
 est = Estimator(...) -> est = SKCompat(Estimator(...))
INFO:tensorflow:Starting evaluation at 2017-06-15-14:12:29
2017-06-15 17:12:29.099495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 650, pci bus id: 0000:01:00.0)
INFO:tensorflow:Restoring parameters from /tmp/mnist_convnet_model/model.ckpt-20001
2017-06-15 17:12:39.168086: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 957.03MiB.  Current allocation summary follows.
2017-06-15 17:12:39.168119: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (256): 	Total Chunks: 1, Chunks in use: 0 256B allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168127: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (512): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168135: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (1024): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168142: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (2048): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168149: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (4096): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168157: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (8192): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168162: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (16384): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168168: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (32768): 	Total Chunks: 1, Chunks in use: 0 39.5KiB allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168174: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (65536): 	Total Chunks: 1, Chunks in use: 0 119.2KiB allocated for chunks. 1B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168178: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (131072): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168183: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (262144): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168188: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (524288): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168192: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168196: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168201: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168207: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0 11.87MiB allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168212: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168217: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168221: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168226: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168231: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (268435456): 	Total Chunks: 1, Chunks in use: 0 287.75MiB allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-15 17:12:39.168237: I tensorflow/core/common_runtime/bfc_allocator.cc:660] Bin for 957.03MiB was 256.00MiB, Chunk State:
2017-06-15 17:12:39.168245: I tensorflow/core/common_runtime/bfc_allocator.cc:666]   Size: 287.75MiB | Requested Size: 4B | in_use: 0, prev:   Size: 29.91MiB | Requested Size: 29.91MiB | in_use: 1
2017-06-15 17:12:39.168251: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba0000 of size 1280
2017-06-15 17:12:39.168255: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba0500 of size 1280
2017-06-15 17:12:39.168258: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba0a00 of size 256
2017-06-15 17:12:39.168262: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba0b00 of size 256
2017-06-15 17:12:39.168265: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba0c00 of size 256
2017-06-15 17:12:39.168269: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba0d00 of size 256
2017-06-15 17:12:39.168272: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba0e00 of size 256
2017-06-15 17:12:39.168276: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba0f00 of size 256
2017-06-15 17:12:39.168279: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1000 of size 256
2017-06-15 17:12:39.168282: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1100 of size 256
2017-06-15 17:12:39.168286: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1200 of size 256
2017-06-15 17:12:39.168289: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1300 of size 256
2017-06-15 17:12:39.168293: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1400 of size 256
2017-06-15 17:12:39.168296: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1500 of size 256
2017-06-15 17:12:39.168300: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1600 of size 256
2017-06-15 17:12:39.168303: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1700 of size 256
2017-06-15 17:12:39.168306: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1800 of size 256
2017-06-15 17:12:39.168310: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1900 of size 256
2017-06-15 17:12:39.168314: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba1a00 of size 3328
2017-06-15 17:12:39.168317: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba2700 of size 256
2017-06-15 17:12:39.168321: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500ba2800 of size 256
2017-06-15 17:12:39.168324: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500bac700 of size 4096
2017-06-15 17:12:39.168328: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500bad700 of size 40960
2017-06-15 17:12:39.168331: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500bb7700 of size 256
2017-06-15 17:12:39.168335: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500bb7900 of size 256
2017-06-15 17:12:39.168338: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500bd5700 of size 204800
2017-06-15 17:12:39.168342: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x500c07700 of size 400128
2017-06-15 17:12:39.168345: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x501847700 of size 12845056
2017-06-15 17:12:39.168349: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x502487700 of size 31360000
2017-06-15 17:12:39.168353: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x500ba2900 of size 40448
2017-06-15 17:12:39.168356: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x500bb7800 of size 256
2017-06-15 17:12:39.168360: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x500bb7a00 of size 122112
2017-06-15 17:12:39.168364: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x500c69200 of size 12444928
2017-06-15 17:12:39.168367: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x50426fb00 of size 301729024
2017-06-15 17:12:39.168371: I tensorflow/core/common_runtime/bfc_allocator.cc:693]      Summary of in-use Chunks by size:
2017-06-15 17:12:39.168376: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 20 Chunks of size 256 totalling 5.0KiB
2017-06-15 17:12:39.168380: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 2 Chunks of size 1280 totalling 2.5KiB
2017-06-15 17:12:39.168384: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 3328 totalling 3.2KiB
2017-06-15 17:12:39.168388: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 4096 totalling 4.0KiB
2017-06-15 17:12:39.168393: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 40960 totalling 40.0KiB
2017-06-15 17:12:39.168397: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 204800 totalling 200.0KiB
2017-06-15 17:12:39.168402: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 400128 totalling 390.8KiB
2017-06-15 17:12:39.168406: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 12845056 totalling 12.25MiB
2017-06-15 17:12:39.168410: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 31360000 totalling 29.91MiB
2017-06-15 17:12:39.168415: I tensorflow/core/common_runtime/bfc_allocator.cc:700] Sum Total of in-use chunks: 42.79MiB
2017-06-15 17:12:39.168421: I tensorflow/core/common_runtime/bfc_allocator.cc:702] Stats:
Limit:                   359202816
InUse:                    44866048
MaxInUse:                133534976
NumAllocs:                 1501313
MaxAllocSize:             88576000

2017-06-15 17:12:39.168429: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *__**************___________________________________________________________________________________
2017-06-15 17:12:39.168441: W tensorflow/core/framework/op_kernel.cc:1152] Resource exhausted: OOM when allocating tensor with shape[10000,28,28,32]
Traceback (most recent call last):
 File "mnist_cnn_layer.py", line 152, in <module>
   tf.app.run()
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 48, in run
   _sys.exit(main(_sys.argv[:1] + flags_passthrough))
 File "mnist_cnn_layer.py", line 147, in main
   x=eval_data, y=eval_labels, metrics=metrics)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py", line 281, in new_func
   return func(*args, **kwargs)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 505, in evaluate
   return SKCompat(self).score(x, y, batch_size, steps, metrics)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 1332, in score
   name='score')
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 828, in _evaluate_model
   config=config_pb2.ConfigProto(allow_soft_placement=True))
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/training/evaluation.py", line 182, in _evaluate_once
   session.run(eval_ops, feed_dict)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 484, in run
   run_metadata=run_metadata)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 820, in run
   run_metadata=run_metadata)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 776, in run
   return self._sess.run(*args, **kwargs)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 930, in run
   run_metadata=run_metadata)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 776, in run
   return self._sess.run(*args, **kwargs)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 778, in run
   run_metadata_ptr)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 982, in _run
   feed_dict_string, options, run_metadata)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1032, in _do_run
   target_list, options, run_metadata)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1052, in _do_call
   raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10000,28,28,32]
  [[Node: conv2d/convolution = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/gpu:0"](Reshape, conv2d/kernel/read)]]

Caused by op u'conv2d/convolution', defined at:
 File "mnist_cnn_layer.py", line 152, in <module>
   tf.app.run()
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 48, in run
   _sys.exit(main(_sys.argv[:1] + flags_passthrough))
 File "mnist_cnn_layer.py", line 147, in main
   x=eval_data, y=eval_labels, metrics=metrics)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py", line 281, in new_func
   return func(*args, **kwargs)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 505, in evaluate
   return SKCompat(self).score(x, y, batch_size, steps, metrics)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 1332, in score
   name='score')
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 804, in _evaluate_model
   eval_dict = self._get_eval_ops(features, labels, metrics).eval_metric_ops
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 1160, in _get_eval_ops
   features, labels, model_fn_lib.ModeKeys.EVAL)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 1103, in _call_model_fn
   model_fn_results = self._model_fn(features, labels, **kwargs)
 File "mnist_cnn_layer.py", line 36, in cnn_model_fn
   activation=tf.nn.relu)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/layers/convolutional.py", line 511, in conv2d
   return layer.apply(inputs)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/layers/base.py", line 320, in apply
   return self.__call__(inputs, **kwargs)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/layers/base.py", line 290, in __call__
   outputs = self.call(inputs, **kwargs)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/layers/convolutional.py", line 156, in call
   data_format=utils.convert_data_format(self.data_format, self.rank + 2))
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 661, in convolution
   op=op)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 331, in with_space_to_batch
   return op(input, num_spatial_dims, padding)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 653, in op
   name=name)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 129, in _non_atrous_convolution
   name=name)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 403, in conv2d
   data_format=data_format, name=name)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py", line 768, in apply_op
   op_def=op_def)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 2336, in create_op
   original_op=self._default_original_op, op_def=op_def)
 File "/home/lhuynh/tfgpu/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 1228, in __init__
   self._traceback = _extract_stack()

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10000,28,28,32]
  [[Node: conv2d/convolution = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/gpu:0"](Reshape, conv2d/kernel/read)]]

*********************************************2017-06-17 02:06:41***************************************************************************************
cse-cn0011: 8 x Tesla K80
Device mapping:
/job:localhost/replica:0/task:0/gpu:0 -> device: 0, name: Tesla K80, pci bus id: 0000:05:00.0
/job:localhost/replica:0/task:0/gpu:1 -> device: 1, name: Tesla K80, pci bus id: 0000:06:00.0
/job:localhost/replica:0/task:0/gpu:2 -> device: 2, name: Tesla K80, pci bus id: 0000:09:00.0
/job:localhost/replica:0/task:0/gpu:3 -> device: 3, name: Tesla K80, pci bus id: 0000:0a:00.0
/job:localhost/replica:0/task:0/gpu:4 -> device: 4, name: Tesla K80, pci bus id: 0000:84:00.0
/job:localhost/replica:0/task:0/gpu:5 -> device: 5, name: Tesla K80, pci bus id: 0000:85:00.0
/job:localhost/replica:0/task:0/gpu:6 -> device: 6, name: Tesla K80, pci bus id: 0000:88:00.0
/job:localhost/replica:0/task:0/gpu:7 -> device: 7, name: Tesla K80, pci bus id: 0000:89:00.0
2017-06-17 02:06:41.057137: I tensorflow/core/common_runtime/direct_session.cc:265] Device mapping:
/job:localhost/replica:0/task:0/gpu:0 -> device: 0, name: Tesla K80, pci bus id: 0000:05:00.0
/job:localhost/replica:0/task:0/gpu:1 -> device: 1, name: Tesla K80, pci bus id: 0000:06:00.0
/job:localhost/replica:0/task:0/gpu:2 -> device: 2, name: Tesla K80, pci bus id: 0000:09:00.0
/job:localhost/replica:0/task:0/gpu:3 -> device: 3, name: Tesla K80, pci bus id: 0000:0a:00.0
/job:localhost/replica:0/task:0/gpu:4 -> device: 4, name: Tesla K80, pci bus id: 0000:84:00.0
/job:localhost/replica:0/task:0/gpu:5 -> device: 5, name: Tesla K80, pci bus id: 0000:85:00.0
/job:localhost/replica:0/task:0/gpu:6 -> device: 6, name: Tesla K80, pci bus id: 0000:88:00.0
/job:localhost/replica:0/task:0/gpu:7 -> device: 7, name: Tesla K80, pci bus id: 0000:89:00.0

MatMul: (MatMul): /job:localhost/replica:0/task:0/gpu:0
2017-06-17 02:06:41.059001: I tensorflow/core/common_runtime/simple_placer.cc:847] MatMul: (MatMul)/job:localhost/replica:0/task:0/gpu:0
b: (Const): /job:localhost/replica:0/task:0/gpu:0
2017-06-17 02:06:41.059040: I tensorflow/core/common_runtime/simple_placer.cc:847] b: (Const)/job:localhost/replica:0/task:0/gpu:0
a: (Const): /job:localhost/replica:0/task:0/gpu:0
2017-06-17 02:06:41.059070: I tensorflow/core/common_runtime/simple_placer.cc:847] a: (Const)/job:localhost/replica:0/task:0/gpu:0
[[ 22.  28.]
 [ 49.  64.]]

 cse-cn0003: Tesla K20m
 Device mapping:
/job:localhost/replica:0/task:0/gpu:0 -> device: 0, name: Tesla K20m, pci bus id: 0000:04:00.0
2017-06-17 02:14:42.201600: I tensorflow/core/common_runtime/direct_session.cc:265] Device mapping:
/job:localhost/replica:0/task:0/gpu:0 -> device: 0, name: Tesla K20m, pci bus id: 0000:04:00.0

MatMul: (MatMul): /job:localhost/replica:0/task:0/gpu:0
2017-06-17 02:14:42.202574: I tensorflow/core/common_runtime/simple_placer.cc:847] MatMul: (MatMul)/job:localhost/replica:0/task:0/gpu:0
b: (Const): /job:localhost/replica:0/task:0/gpu:0
2017-06-17 02:14:42.202604: I tensorflow/core/common_runtime/simple_placer.cc:847] b: (Const)/job:localhost/replica:0/task:0/gpu:0
a: (Const): /job:localhost/replica:0/task:0/gpu:0
2017-06-17 02:14:42.202628: I tensorflow/core/common_runtime/simple_placer.cc:847] a: (Const)/job:localhost/replica:0/task:0/gpu:0
[[ 22.  28.]
 [ 49.  64.]]


****************************************************************************************************************************************************
0.00002226  0.00003979  0.00013011  0.00131065]] (0.775 sec)
INFO:tensorflow:probabilities = [[ 0.00000054  0.00000011  0.00000006  0.00004669  0.00149298  0.00011587
 0.00000003  0.00392465  0.00000088  0.99441826]
[ 0.00007543  0.85219884  0.00201594  0.08537367  0.00953213  0.02491898
 0.00720642  0.0008203   0.01635707  0.00150124]
[ 0.00002964  0.00000409  0.00067104  0.00000205  0.00019441  0.0000827
 0.9989208   0.00000003  0.00009452  0.00000084]
[ 0.99989331  0.          0.00000125  0.00000001  0.00000003  0.00006592
 0.00003679  0.00000009  0.00000194  0.00000064]
[ 0.00005442  0.0000001   0.00028632  0.0008797   0.00004325  0.01522389
 0.00035016  0.00000045  0.97148854  0.0116732 ]
[ 0.00095049  0.00000026  0.00021196  0.00024513  0.000018    0.00025315
 0.00144244  0.00000002  0.99605978  0.0008188 ]
[ 0.00000054  0.00000003  0.00006138  0.00010964  0.00000502  0.00007059
 0.00000085  0.00000123  0.99960107  0.00014967]
[ 0.00011398  0.0000613   0.00000483  0.00291528  0.00000788  0.99642247
 0.00000433  0.00012767  0.00029982  0.0000424 ]
[ 0.00000642  0.00000606  0.00504343  0.00000429  0.00077667  0.00058886
 0.9931497   0.00000056  0.00042112  0.00000293]
[ 0.0001403   0.00008226  0.0001012   0.00073792  0.00773013  0.00675367
 0.00001477  0.79740208  0.00104529  0.18599232]
[ 0.03614056  0.0000014   0.94595021  0.0001222   0.00024944  0.00004164
 0.00737036  0.00004717  0.00981741  0.00025963]
[ 0.00009163  0.00024078  0.00100275  0.01021497  0.00015598  0.00053998
 0.01505711  0.00000464  0.97258276  0.00010943]
[ 0.00001196  0.00004841  0.00000622  0.00000416  0.00001     0.00360024
 0.99631244  0.00000002  0.00000662  0.00000003]
[ 0.00022703  0.00003295  0.00047738  0.000002    0.00019629  0.00742666
 0.98443049  0.00000001  0.00719987  0.00000723]
[ 0.          0.00000003  0.00021852  0.99851888  0.          0.00000182
 0.          0.00000407  0.00123004  0.00002669]
[ 0.00327333  0.00001471  0.01920368  0.0612331   0.0000668   0.01508532
 0.03878549  0.00000002  0.86207873  0.00025873]
[ 0.00000031  0.00042724  0.9980914   0.00094544  0.          0.00000018
 0.00000151  0.          0.00053383  0.        ]
[ 0.01000092  0.00001744  0.00053484  0.0196289   0.00026196  0.03746619
 0.00535695  0.00000776  0.92495954  0.00176546]
[ 0.00021114  0.00000056  0.00050314  0.53938764  0.00000648  0.3437278
 0.00000379  0.00001333  0.10458461  0.01156154]
[ 0.99972874  0.          0.0002121   0.0000508   0.00000008  0.00000051
 0.00000155  0.00000008  0.00000124  0.00000489]
[ 0.00001456  0.00001125  0.00032479  0.00018293  0.00113298  0.62409461
 0.34150958  0.00000011  0.03269776  0.00003154]
[ 0.00059339  0.00000024  0.00003228  0.00000199  0.00042351  0.00013845
 0.99877995  0.00000002  0.00002913  0.000001  ]
[ 0.00025194  0.99136752  0.00021737  0.0003469   0.00202009  0.00027377
 0.00078912  0.00156472  0.00276075  0.00040775]
[ 0.00000239  0.00039692  0.0000647   0.00013036  0.99748695  0.00006971
 0.00147619  0.00005977  0.00003507  0.00027792]
[ 0.00000007  0.00000015  0.9999299   0.00004213  0.          0.00000004
 0.          0.          0.00002775  0.        ]
[ 0.00032171  0.00000271  0.00000229  0.00405591  0.00001543  0.9950369
 0.00001691  0.0000491   0.00002652  0.00047255]
[ 0.0000169   0.          0.00000944  0.00136903  0.00000037  0.95813686
 0.00000047  0.00000054  0.04045584  0.00001053]
[ 0.98902053  0.0000035   0.00003758  0.00088639  0.00000604  0.00700226
 0.00018229  0.00268483  0.00001422  0.00016246]
[ 0.00000007  0.00000055  0.00000027  0.00005063  0.0530207   0.00012491
 0.00000043  0.00022078  0.00117767  0.94540393]
[ 0.00002411  0.89049858  0.00066755  0.00843395  0.02863524  0.00081482
 0.00029896  0.00130712  0.03270161  0.03661799]
[ 0.00003259  0.99299318  0.0001383   0.00059824  0.00094369  0.00026284
 0.00007089  0.00215185  0.00117633  0.00163225]
[ 0.00044931  0.00002588  0.00004994  0.00020302  0.00041311  0.00023001
 0.99695539  0.00000101  0.00124644  0.00042588]
[ 0.          0.0000001   0.00000023  0.00000075  0.99993181  0.00000179
 0.00000043  0.00000005  0.00000432  0.00006037]
[ 0.00616739  0.00182251  0.00098733  0.00194071  0.00012265  0.02591743
 0.00065126  0.00054483  0.95649099  0.00535484]
[ 0.00012581  0.93979001  0.00320716  0.004304    0.01219967  0.00501461
 0.00403054  0.0000897   0.03104458  0.00019392]
[ 0.00000184  0.00000073  0.01138931  0.98466748  0.00000031  0.00007025
 0.00000002  0.00000012  0.00385445  0.00001549]
[ 0.99644971  0.0000033   0.00024332  0.00000737  0.00003053  0.00018981
 0.002918    0.00000728  0.00008708  0.00006351]
[ 0.00000029  0.00000002  0.00000062  0.00019188  0.00156851  0.00011083
 0.00000001  0.01588362  0.00013992  0.98210436]
[ 0.0000853   0.00000234  0.00003134  0.00007192  0.00392005  0.00050142
 0.00004933  0.00069125  0.00040081  0.99424618]
[ 0.00000521  0.9548856   0.00002192  0.00109771  0.00048366  0.00000306
 0.00003635  0.00000585  0.0434419   0.00001867]
[ 0.00011825  0.98363727  0.00096498  0.00123661  0.0018745   0.00307688
 0.00014962  0.00102114  0.00776238  0.00015846]
[ 0.00463799  0.0000133   0.00000388  0.00065035  0.00052965  0.00423455
 0.00000154  0.98100948  0.00008162  0.0088377 ]
[ 0.00006325  0.00007988  0.99022466  0.0058817   0.00011095  0.00007517
 0.00000008  0.00284695  0.00002779  0.00068956]
[ 0.99885499  0.00000089  0.00025693  0.00002556  0.00000002  0.00065868
 0.00001005  0.00011576  0.0000031   0.000074  ]
[ 0.00005433  0.00000899  0.00007726  0.00090098  0.01558948  0.00013885
 0.00000239  0.01076369  0.00018795  0.97227603]
[ 0.00006735  0.99798882  0.00063184  0.00030026  0.00003267  0.00000265
 0.00003405  0.00033717  0.0005038   0.00010145]
[ 0.00022008  0.09939268  0.00314517  0.00198837  0.70698923  0.00752317
 0.00694246  0.00526001  0.16088879  0.00765014]
[ 0.00053174  0.00000961  0.00014339  0.00000119  0.00007916  0.00034507
 0.99840218  0.00000003  0.00048673  0.00000084]
[ 0.          0.00000084  0.9999944   0.00000456  0.00000025  0.
 0.00000004  0.          0.00000004  0.        ]
[ 0.00059617  0.00000868  0.00007611  0.00022617  0.00000716  0.00006419
 0.00002043  0.00000085  0.9989863   0.00001388]
[ 0.00332175  0.00000459  0.9939208   0.00207421  0.0000013   0.00001794
 0.00001027  0.00056891  0.000033    0.0000472 ]
[ 0.00030776  0.98576331  0.00069339  0.0040612   0.00076551  0.00132152
 0.00124609  0.00104598  0.00424575  0.00054942]
[ 0.00006754  0.00264744  0.01246403  0.00031973  0.11403869  0.01781773
 0.85126835  0.00007434  0.00108684  0.00021518]
[ 0.0000012   0.00000019  0.00005323  0.99801719  0.00000022  0.0017704
 0.00000088  0.          0.00015645  0.00000027]
[ 0.00000018  0.          0.0000001   0.00012642  0.00036597  0.00002979
 0.00000002  0.00004225  0.00002542  0.99940991]
[ 0.          0.00000311  0.00000005  0.00003403  0.00993434  0.00003036
 0.00000001  0.00057836  0.00001043  0.98940933]
[ 0.99998808  0.00000001  0.00000136  0.00000067  0.00000001  0.00000343
 0.00000058  0.00000377  0.00000016  0.000002  ]
[ 0.00001382  0.00000249  0.00002995  0.00008809  0.00000158  0.00005885
 0.00000001  0.99133122  0.00000422  0.00846984]
[ 0.00000166  0.00006632  0.00087278  0.94886404  0.00001046  0.00132793
 0.00000029  0.00001035  0.04701946  0.00182675]
[ 0.05873049  0.04288197  0.00709445  0.16567338  0.00090838  0.68821067
 0.01658594  0.00042191  0.00552964  0.01396316]
[ 0.          0.          0.00000013  0.          0.99999821  0.00000001
 0.00000045  0.0000003   0.00000062  0.00000023]
[ 0.00016064  0.00000051  0.00015269  0.0002392   0.0078412   0.00001228
 0.00000333  0.00691463  0.00119258  0.98348296]
[ 0.00000282  0.00000194  0.00004577  0.00000081  0.00015467  0.00034871
 0.99940813  0.          0.00003693  0.00000027]
[ 0.00007031  0.00465809  0.98816878  0.00362113  0.0000012   0.00010698
 0.00003356  0.0026169   0.00071234  0.00001072]
[ 0.00004681  0.00000515  0.00000229  0.02086305  0.0000067   0.97560561
 0.00003104  0.00000165  0.00190567  0.00153203]
[ 0.00000008  0.00009997  0.99862647  0.00013515  0.00000008  0.00000064
 0.00000058  0.00000001  0.00113715  0.        ]
[ 0.00001253  0.00188602  0.00409396  0.00391495  0.00721517  0.00043592
 0.00002294  0.96441042  0.00484876  0.01315932]
[ 0.00000129  0.00000791  0.00010286  0.00003829  0.98539239  0.00005836
 0.00002489  0.00353523  0.00112886  0.00971001]
[ 0.00014151  0.00000029  0.00001425  0.00000194  0.00535017  0.00003266
 0.00000212  0.00155744  0.00009305  0.99280655]
[ 0.00007059  0.99648631  0.00029924  0.00046831  0.00015664  0.00018487
 0.00033945  0.00075831  0.00093484  0.0003014 ]
[ 0.00008646  0.00575662  0.94081408  0.02275384  0.00434306  0.00336579
 0.00386302  0.0000824   0.0177146   0.0012202 ]
[ 0.00033766  0.00000055  0.00113913  0.0043492   0.00000002  0.00001514
 0.00000003  0.99354148  0.00000158  0.00061508]
[ 0.00036433  0.00008591  0.61238098  0.38102624  0.00002108  0.00059087
 0.00003099  0.00008589  0.00538074  0.00003299]
[ 0.00001293  0.05322984  0.91299796  0.03090768  0.00000019  0.00003789
 0.00260253  0.00000001  0.00021108  0.        ]
[ 0.00011607  0.99912113  0.00008379  0.00007966  0.0000588   0.00000331
 0.00008217  0.00015682  0.00029676  0.00000156]
[ 0.00000313  0.00001299  0.00001651  0.02978928  0.00001597  0.05787146
 0.00000943  0.91072905  0.00034936  0.00120282]
[ 0.00000482  0.00000001  0.00033684  0.99735332  0.00000011  0.0018361
 0.          0.00000373  0.00018877  0.0002763 ]
[ 0.00002532  0.99805862  0.00024981  0.00018911  0.00017756  0.00002105
 0.00017479  0.0002757   0.00081675  0.00001116]
[ 0.00003197  0.99138838  0.00027915  0.00016094  0.00011574  0.00007101
 0.00034286  0.00085515  0.00674604  0.00000875]
[ 0.00004407  0.00000463  0.99604094  0.00228002  0.          0.00000087
 0.00000003  0.00023911  0.00138137  0.00000892]
[ 0.0504889   0.00022947  0.00075634  0.00018509  0.00031564  0.1148598
 0.83284301  0.00000069  0.00027934  0.00004176]
[ 0.00006487  0.02727186  0.07265128  0.88339907  0.00000291  0.00011847
 0.00000429  0.00139003  0.01471367  0.00038352]
[ 0.00019415  0.00950686  0.00025581  0.00970676  0.10078464  0.0079047
 0.00067669  0.05238654  0.00285586  0.81572807]
[ 0.00000027  0.00007372  0.99928778  0.00063418  0.          0.00000004
 0.00000002  0.00000038  0.00000372  0.        ]
[ 0.00000038  0.00000107  0.00000018  0.00002859  0.01585168  0.00005343
 0.00000057  0.00078408  0.00009734  0.98318267]
[ 0.00000043  0.00000075  0.00040554  0.00862404  0.00000175  0.00052582
 0.00000333  0.0000026   0.99041712  0.00001868]
[ 0.00083366  0.00481752  0.00060016  0.00075647  0.00672302  0.03886113
 0.90775508  0.00000421  0.03901249  0.00063628]
[ 0.00001703  0.99710768  0.00003374  0.00130297  0.00007499  0.00005615
 0.00005214  0.00041577  0.00037892  0.0005606 ]
[ 0.00000003  0.000001    0.0003054   0.99916101  0.00000013  0.0004575
 0.0000001   0.00000003  0.00007436  0.00000039]
[ 0.00000935  0.00000128  0.00001687  0.00002611  0.99894446  0.0000116
 0.00002338  0.00003523  0.00002578  0.00090587]
[ 0.0115805   0.04985867  0.87867838  0.03826327  0.00005857  0.0005737
 0.01009428  0.00009107  0.01073204  0.0000694 ]
[ 0.99571723  0.00000002  0.00003739  0.00002319  0.00000011  0.00355665
 0.00000917  0.00006568  0.00013605  0.00045443]
[ 0.80518323  0.00001296  0.00087713  0.00321349  0.00000654  0.02384184
 0.00002809  0.00421478  0.00013761  0.16248442]
[ 0.0000035   0.00000004  0.00002212  0.00002043  0.00050356  0.0001027
 0.0000006   0.00111028  0.00023031  0.9980064 ]
[ 0.00035384  0.00000296  0.02209985  0.00364475  0.00086991  0.01211705
 0.00010117  0.01438608  0.01158227  0.93484205]
[ 0.01934095  0.00178845  0.950234    0.01352042  0.00000169  0.00535051
 0.00006133  0.00245156  0.00707937  0.00017167]
[ 0.00000464  0.00000147  0.0002387   0.00110278  0.00000015  0.00000153
 0.          0.99821174  0.00000373  0.00043532]
[ 0.00026291  0.0000077   0.00046541  0.00325055  0.00008773  0.00315021
 0.00195231  0.00000155  0.98857456  0.00224714]
[ 0.00000616  0.00000047  0.00001553  0.00014755  0.0000004   0.00002215
 0.00000001  0.99939609  0.00014859  0.00026319]
[ 0.00000331  0.00000401  0.00000745  0.00904929  0.00000948  0.98866302
 0.00080136  0.00000005  0.00134469  0.00011722]] (0.752 sec)
INFO:tensorflow:Saving checkpoints for 20006 into /tmp/mnist_convnet_model/model.ckpt.
INFO:tensorflow:Loss for final step: 0.099359.
WARNING:tensorflow:From mnist_cnn_layer.py:135: calling evaluate (from tensorflow.contrib.learn.python.learn.estimators.estimator) with y is deprecated and will be removed after 2016-12-01.
Instructions for updating:
Estimator is decoupled from Scikit Learn interface by moving into
separate class SKCompat. Arguments x, y and batch_size are only
available in the SKCompat class, Estimator will only accept input_fn.
Example conversion:
est = Estimator(...) -> est = SKCompat(Estimator(...))
WARNING:tensorflow:From mnist_cnn_layer.py:135: calling evaluate (from tensorflow.contrib.learn.python.learn.estimators.estimator) with x is deprecated and will be removed after 2016-12-01.
Instructions for updating:
Estimator is decoupled from Scikit Learn interface by moving into
separate class SKCompat. Arguments x, y and batch_size are only
available in the SKCompat class, Estimator will only accept input_fn.
Example conversion:
est = Estimator(...) -> est = SKCompat(Estimator(...))
INFO:tensorflow:Starting evaluation at 2017-06-17-10:55:30
2017-06-17 13:55:31.050432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:05:00.0)
2017-06-17 13:55:31.050503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:06:00.0)
2017-06-17 13:55:31.050522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:09:00.0)
2017-06-17 13:55:31.050538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:0a:00.0)
2017-06-17 13:55:31.050557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:4) -> (device: 4, name: Tesla K80, pci bus id: 0000:84:00.0)
2017-06-17 13:55:31.050575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:5) -> (device: 5, name: Tesla K80, pci bus id: 0000:85:00.0)
2017-06-17 13:55:31.050593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:6) -> (device: 6, name: Tesla K80, pci bus id: 0000:88:00.0)
2017-06-17 13:55:31.050613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:7) -> (device: 7, name: Tesla K80, pci bus id: 0000:89:00.0)
INFO:tensorflow:Restoring parameters from /tmp/mnist_convnet_model/model.ckpt-20006
2017-06-17 13:55:41.182727: W tensorflow/core/common_runtime/bfc_allocator.cc:273] Allocator (GPU_0_bfc) ran out of memory trying to allocate 957.03MiB.  Current allocation summary follows.
2017-06-17 13:55:41.182792: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (256): 	Total Chunks: 1, Chunks in use: 0 256B allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182819: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (512): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182832: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (1024): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182851: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (2048): 	Total Chunks: 1, Chunks in use: 0 3.0KiB allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182874: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (4096): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182887: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (8192): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182899: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (16384): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182913: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (32768): 	Total Chunks: 1, Chunks in use: 0 32.0KiB allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182926: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (65536): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182941: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (131072): 	Total Chunks: 1, Chunks in use: 0 200.0KiB allocated for chunks. 39.1KiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182954: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (262144): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182965: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (524288): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182977: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.182989: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.183000: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.183013: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (8388608): 	Total Chunks: 1, Chunks in use: 0 11.87MiB allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.183026: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.183038: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.183049: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.183062: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (134217728): 	Total Chunks: 1, Chunks in use: 0 205.80MiB allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.183075: I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
2017-06-17 13:55:41.183088: I tensorflow/core/common_runtime/bfc_allocator.cc:660] Bin for 957.03MiB was 256.00MiB, Chunk State:
2017-06-17 13:55:41.183100: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228700000 of size 1280
2017-06-17 13:55:41.183108: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228700500 of size 1280
2017-06-17 13:55:41.183116: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228700a00 of size 256
2017-06-17 13:55:41.183124: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228700b00 of size 256
2017-06-17 13:55:41.183132: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228700c00 of size 256
2017-06-17 13:55:41.183140: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228700d00 of size 256
2017-06-17 13:55:41.183148: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228700e00 of size 256
2017-06-17 13:55:41.183155: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228700f00 of size 256
2017-06-17 13:55:41.183163: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228701000 of size 256
2017-06-17 13:55:41.183170: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228701100 of size 256
2017-06-17 13:55:41.183178: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228701200 of size 256
2017-06-17 13:55:41.183186: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228701300 of size 256
2017-06-17 13:55:41.183194: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228701400 of size 256
2017-06-17 13:55:41.183201: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228701500 of size 256
2017-06-17 13:55:41.183209: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228701600 of size 256
2017-06-17 13:55:41.183218: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228701700 of size 3328
2017-06-17 13:55:41.183242: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228702400 of size 256
2017-06-17 13:55:41.183250: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228702500 of size 256
2017-06-17 13:55:41.183258: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228702700 of size 256
2017-06-17 13:55:41.183266: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228703400 of size 4096
2017-06-17 13:55:41.183274: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x122870c400 of size 40960
2017-06-17 13:55:41.183282: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1228748400 of size 204800
2017-06-17 13:55:41.183290: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x122877a400 of size 400128
2017-06-17 13:55:41.183298: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x12293ba400 of size 12845056
2017-06-17 13:55:41.183306: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1229ffa400 of size 31360000
2017-06-17 13:55:41.183314: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x1228702600 of size 256
2017-06-17 13:55:41.183321: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x1228702800 of size 3072
2017-06-17 13:55:41.183329: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x1228704400 of size 32768
2017-06-17 13:55:41.183337: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x1228716400 of size 204800
2017-06-17 13:55:41.183344: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x12287dbf00 of size 12444928
2017-06-17 13:55:41.183352: I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x122bde2800 of size 215799808
2017-06-17 13:55:41.183359: I tensorflow/core/common_runtime/bfc_allocator.cc:693]      Summary of in-use Chunks by size:
2017-06-17 13:55:41.183370: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 16 Chunks of size 256 totalling 4.0KiB
2017-06-17 13:55:41.183380: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 2 Chunks of size 1280 totalling 2.5KiB
2017-06-17 13:55:41.183389: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 3328 totalling 3.2KiB
2017-06-17 13:55:41.183398: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 4096 totalling 4.0KiB
2017-06-17 13:55:41.183407: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 40960 totalling 40.0KiB
2017-06-17 13:55:41.183417: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 204800 totalling 200.0KiB
2017-06-17 13:55:41.183427: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 400128 totalling 390.8KiB
2017-06-17 13:55:41.183437: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 12845056 totalling 12.25MiB
2017-06-17 13:55:41.183447: I tensorflow/core/common_runtime/bfc_allocator.cc:696] 1 Chunks of size 31360000 totalling 29.91MiB
2017-06-17 13:55:41.183456: I tensorflow/core/common_runtime/bfc_allocator.cc:700] Sum Total of in-use chunks: 42.79MiB
2017-06-17 13:55:41.183470: I tensorflow/core/common_runtime/bfc_allocator.cc:702] Stats:
Limit:                   273350656
InUse:                    44865024
MaxInUse:                136910592
NumAllocs:                 1441301
MaxAllocSize:             88576000

2017-06-17 13:55:41.183487: W tensorflow/core/common_runtime/bfc_allocator.cc:277] *___******************______________________________________________________________________________
2017-06-17 13:55:41.183514: W tensorflow/core/framework/op_kernel.cc:1158] Resource exhausted: OOM when allocating tensor with shape[10000,28,28,32]
Traceback (most recent call last):
File "mnist_cnn_layer.py", line 144, in <module>
  tf.app.run()
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 48, in run
  _sys.exit(main(_sys.argv[:1] + flags_passthrough))
File "mnist_cnn_layer.py", line 135, in main
  eval_results = mnist_classifier.evaluate(x=eval_data, y=eval_labels, metrics=metrics)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py", line 289, in new_func
  return func(*args, **kwargs)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 530, in evaluate
  return SKCompat(self).score(x, y, batch_size, steps, metrics)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 1365, in score
  name='score')
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 855, in _evaluate_model
  config=self._session_config)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/training/evaluation.py", line 182, in _evaluate_once
  session.run(eval_ops, feed_dict)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 505, in run
  run_metadata=run_metadata)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 842, in run
  run_metadata=run_metadata)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 798, in run
  return self._sess.run(*args, **kwargs)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 952, in run
  run_metadata=run_metadata)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py", line 798, in run
  return self._sess.run(*args, **kwargs)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 789, in run
  run_metadata_ptr)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 997, in _run
  feed_dict_string, options, run_metadata)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1132, in _do_run
  target_list, options, run_metadata)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1152, in _do_call
  raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[10000,28,28,32]
 [[Node: conv2d/convolution = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/gpu:0"](Reshape, conv2d/kernel/read)]]

Caused by op u'conv2d/convolution', defined at:
File "mnist_cnn_layer.py", line 144, in <module>
  tf.app.run()
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 48, in run
  _sys.exit(main(_sys.argv[:1] + flags_passthrough))
File "mnist_cnn_layer.py", line 135, in main
  eval_results = mnist_classifier.evaluate(x=eval_data, y=eval_labels, metrics=metrics)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py", line 289, in new_func
  return func(*args, **kwargs)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 530, in evaluate
  return SKCompat(self).score(x, y, batch_size, steps, metrics)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 1365, in score
  name='score')
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 829, in _evaluate_model
  model_fn_results = self._get_eval_ops(features, labels, metrics)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 1190, in _get_eval_ops
  features, labels, model_fn_lib.ModeKeys.EVAL)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py", line 1133, in _call_model_fn
  model_fn_results = self._model_fn(features, labels, **kwargs)
File "mnist_cnn_layer.py", line 36, in cnn_model_fn
  activation=tf.nn.relu)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/layers/convolutional.py", line 551, in conv2d
  return layer.apply(inputs)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/layers/base.py", line 492, in apply
  return self.__call__(inputs, *args, **kwargs)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/layers/base.py", line 441, in __call__
  outputs = self.call(inputs, *args, **kwargs)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/layers/convolutional.py", line 158, in call
  data_format=utils.convert_data_format(self.data_format, self.rank + 2))
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 670, in convolution
  op=op)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 338, in with_space_to_batch
  return op(input, num_spatial_dims, padding)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 662, in op
  name=name)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py", line 131, in _non_atrous_convolution
  name=name)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 399, in conv2d
  data_format=data_format, name=name)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py", line 767, in apply_op
  op_def=op_def)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 2506, in create_op
  original_op=self._default_original_op, op_def=op_def)
File "/home/lhuynh/Desktop/pyvenv/tfgpu/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 1269, in __init__
  self._traceback = _extract_stack()

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[10000,28,28,32]
 [[Node: conv2d/convolution = Conv2D[T=DT_FLOAT, data_format="NHWC", padding="SAME", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device="/job:localhost/replica:0/task:0/gpu:0"](Reshape, conv2d/kernel/read)]]


 *********************************************keras MNIST************************************************************************
 60000/60000 [==============================] - 53s - loss: 0.2707 - acc: 0.9188
Epoch 2/10
60000/60000 [==============================] - 42s - loss: 0.1148 - acc: 0.9667
Epoch 3/10
60000/60000 [==============================] - 44s - loss: 0.0856 - acc: 0.9745
Epoch 4/10
60000/60000 [==============================] - 41s - loss: 0.0724 - acc: 0.9787     
Epoch 5/10
60000/60000 [==============================] - 47s - loss: 0.0618 - acc: 0.9810
Epoch 6/10
60000/60000 [==============================] - 42s - loss: 0.0545 - acc: 0.9827
Epoch 7/10
60000/60000 [==============================] - 44s - loss: 0.0469 - acc: 0.9854
Epoch 8/10
60000/60000 [==============================] - 41s - loss: 0.0427 - acc: 0.9864
Epoch 9/10
60000/60000 [==============================] - 42s - loss: 0.0397 - acc: 0.9874
Epoch 10/10
60000/60000 [==============================] - 41s - loss: 0.0379 - acc: 0.9879
******* Testing *******
 9984/10000 [============================>.] - ETA: 0s
 test_result: [0.032672276384178897, 0.99029999999999996]
